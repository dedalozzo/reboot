var api="http://api.programmazione.me/";function like(){$("article > section.item-content > ul.item-buttons > li > button.btn-like").click(function(c){c.preventDefault();var a=$(this).parents("article").attr("id");var b=$(this);$.ajax({type:"POST",url:api+"like/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(d){score=b.closest("ul").find("button.score");votesCount=Number(score.text());if(d[0]){switch(d[1]){case 1:votesCount++;b.addClass("active");break;case 2:votesCount--;b.removeClass("active");break;case 3:break}}else{alert(d[1])}score.text(votesCount)}})})}function star(){var a=$("button.btn-star");a.click(function(c){c.preventDefault();var b=$("article").attr("id");$.ajax({type:"POST",url:api+"star/",xhrFields:{withCredentials:true},dataType:"json",data:{id:b},success:function(d){if(d[0]){switch(d[1]){case 1:a.addClass("active");break;case 2:a.removeClass("active");break}}else{alert(d[1])}}})})}function submit(){}function approve(){}function returnForRevision(){}function reject(){}function revert(){}function moveToTrash(){$(document).on("click","#m-trash",function(b){b.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"move-to-trash/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(c){if(c[0]){$("#b-admin").trigger("click")}else{alert(c[1])}}})})}function restore(){$(document).on("click","#m-undo",function(b){b.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"restore/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(c){if(c[0]){$("#b-admin").trigger("click")}else{alert(c[1])}}})})}function markAsDraft(a){}function close(){$(document).on("click","#m-close",function(b){b.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"close/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(c){if(c[0]){$("#b-admin").trigger("click")}else{alert(c[1])}}})})}function lock(){$(document).on("click","#m-lock",function(b){b.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"lock/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(c){if(c[0]){$("#b-admin").trigger("click")}else{alert(c[1])}}})})}function unprotect(){$(document).on("click","#m-unprotect",function(b){b.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"unprotect/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(c){if(c[0]){$("#b-admin").trigger("click")}else{alert(c[1])}}})})}function hide(){$(document).on("click","#m-hide",function(b){b.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"hide/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(c){if(c[0]){$("#b-admin").trigger("click")}else{alert(c[1])}}})})}function show(){$(document).on("click","#m-show",function(b){b.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"show/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(c){if(c[0]){$("#b-admin").trigger("click")}else{alert(c[1])}}})})}function buildToolsMenu(){$(document).on("click","#b-admin",function(b){b.preventDefault();var a=$(this).parents("article").attr("id");var c=$("#dropdown-moderator");if(c.css("display")=="block"){c.load("http://programmazione.me/ajax/moderator-menu/",{id:a},function(){var g=$(".dropdown:visible").eq(0),d=g.data("dropdown-trigger"),e=d?parseInt(d.attr("data-horizontal-offset")||0,10):null,f=d?parseInt(d.attr("data-vertical-offset")||0,10):null;if(g.length===0||!d){return}if(g.hasClass("dropdown-relative")){g.css({left:g.hasClass("dropdown-anchor-right")?d.position().left-(g.outerWidth(true)-d.outerWidth(true))-parseInt(d.css("margin-right"),10)+e:d.position().left+parseInt(d.css("margin-left"),10)+e,top:d.position().top+d.outerHeight(true)-parseInt(d.css("margin-top"),10)+f})}else{g.css({left:g.hasClass("dropdown-anchor-right")?d.offset().left-(g.outerWidth()-d.outerWidth())+e:d.offset().left+e,top:d.offset().top+d.outerHeight()+f})}})}else{c.empty()}})}$(document).ready(function(){like();star();submit();approve();returnForRevision();reject();revert();moveToTrash();restore();markAsDraft();close();lock();unprotect();hide();show();buildToolsMenu()});