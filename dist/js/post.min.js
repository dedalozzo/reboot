var api="http://programmazione.me/api/";function like(a){$("article > section.item-content > ul.item-buttons > li > button.btn-like").click(function(d){d.preventDefault();var b=$(this).parents("article").attr("id");var c=$(this);$.ajax({type:"POST",url:api+"post/like/",xhrFields:{withCredentials:true},dataType:"json",data:{id:b},success:function(e){score=c.closest("ul").find("button.score");votesCount=Number(score.text());if(e[0]){switch(e[1]){case 1:votesCount++;c.addClass("active");break;case 2:votesCount--;c.removeClass("active");break;case 3:break}}else{alert(e[1])}score.text(votesCount)}})})}function moveToTrash(a){$(document).on("click","#m-trash",function(c){c.preventDefault();var b=$("article").attr("id");$.ajax({type:"POST",url:api+"post/move-to-trash/",xhrFields:{withCredentials:true},dataType:"json",data:{id:b},success:function(d){if(d[0]){$("#b-admin").trigger("click")}else{alert(d[1])}}})})}function restore(a){$(document).on("click","#m-undo",function(c){c.preventDefault();var b=$("article").attr("id");$.ajax({type:"POST",url:api+"post/restore/",xhrFields:{withCredentials:true},dataType:"json",data:{id:b},success:function(d){if(d[0]){$("#b-admin").trigger("click")}else{alert(d[1])}}})})}function close(a){$(document).on("click","#m-close",function(c){c.preventDefault();var b=$("article").attr("id");$.ajax({type:"POST",url:api+"post/close/",xhrFields:{withCredentials:true},dataType:"json",data:{id:b},success:function(d){if(d[0]){$("#b-admin").trigger("click")}else{alert(d[1])}}})})}function lock(a){$(document).on("click","#m-lock",function(c){c.preventDefault();var b=$("article").attr("id");$.ajax({type:"POST",url:api+"post/lock/",xhrFields:{withCredentials:true},dataType:"json",data:{id:b},success:function(d){if(d[0]){$("#b-admin").trigger("click")}else{alert(d[1])}}})})}function unprotect(a){$(document).on("click","#m-unprotect",function(c){c.preventDefault();var b=$("article").attr("id");$.ajax({type:"POST",url:api+"post/unprotect/",xhrFields:{withCredentials:true},dataType:"json",data:{id:b},success:function(d){if(d[0]){$("#b-admin").trigger("click")}else{alert(d[1])}}})})}function hide(a){$(document).on("click","#m-hide",function(c){c.preventDefault();var b=$("article").attr("id");$.ajax({type:"POST",url:api+"post/hide/",xhrFields:{withCredentials:true},dataType:"json",data:{id:b},success:function(d){if(d[0]){$("#b-admin").trigger("click")}else{alert(d[1])}}})})}function show(a){$(document).on("click","#m-show",function(c){c.preventDefault();var b=$("article").attr("id");$.ajax({type:"POST",url:api+"post/show/",xhrFields:{withCredentials:true},dataType:"json",data:{id:b},success:function(d){if(d[0]){$("#b-admin").trigger("click")}else{alert(d[1])}}})})}function buildToolsMenu(a){$(document).on("click","#b-admin",function(c){c.preventDefault();var b=$(this).parents("article").attr("id");var d=$("#dropdown-moderator");if(d.css("display")=="block"){d.load("http://programmazione.me/ajax/moderator-menu/",{id:b},function(){var h=$(".dropdown:visible").eq(0),e=h.data("dropdown-trigger"),f=e?parseInt(e.attr("data-horizontal-offset")||0,10):null,g=e?parseInt(e.attr("data-vertical-offset")||0,10):null;if(h.length===0||!e){return}if(h.hasClass("dropdown-relative")){h.css({left:h.hasClass("dropdown-anchor-right")?e.position().left-(h.outerWidth(true)-e.outerWidth(true))-parseInt(e.css("margin-right"),10)+f:e.position().left+parseInt(e.css("margin-left"),10)+f,top:e.position().top+e.outerHeight(true)-parseInt(e.css("margin-top"),10)+g})}else{h.css({left:h.hasClass("dropdown-anchor-right")?e.offset().left-(h.outerWidth()-e.outerWidth())+f:e.offset().left+f,top:e.offset().top+e.outerHeight()+g})}})}else{d.empty()}})}$(document).ready(function(a){like(a);moveToTrash(a);restore(a);close(a);lock(a);unprotect(a);hide(a);show(a);buildToolsMenu(a)});