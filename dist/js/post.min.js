var api="http://api.programmazione.me/";function like(){$("article > section.item-content > ul.item-buttons > li > button.btn-like").click(function(){event.preventDefault();var a=$(this).parents("article").attr("id");var b=$(this);$.ajax({type:"POST",url:api+"like/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(c){score=b.closest("ul").find("button.score");votesCount=Number(score.text());if(c[0]){switch(c[1]){case 1:votesCount++;b.addClass("active");break;case 2:votesCount--;b.removeClass("active");break;case 3:break}}else{alert(c[1])}score.text(votesCount)}})})}function star(){var a=$("button.btn-star");a.click(function(){event.preventDefault();var b=$("article").attr("id");$.ajax({type:"POST",url:api+"star/",xhrFields:{withCredentials:true},dataType:"json",data:{id:b},success:function(c){if(c[0]){switch(c[1]){case 1:a.addClass("active");break;case 2:a.removeClass("active");break}}else{alert(c[1])}}})})}function submit(){}function approve(){}function returnForRevision(){}function reject(){}function revert(){}function moveToTrash(){$(document).on("click","#m-trash",function(){event.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"move-to-trash/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(b){if(b[0]){$("#b-admin").trigger("click")}else{alert(b[1])}}})})}function restore(){$(document).on("click","#m-undo",function(){event.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"restore/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(b){if(b[0]){$("#b-admin").trigger("click")}else{alert(b[1])}}})})}function markAsDraft(){}function close(){$(document).on("click","#m-close",function(){event.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"close/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(b){if(b[0]){$("#b-admin").trigger("click")}else{alert(b[1])}}})})}function lock(){$(document).on("click","#m-lock",function(){event.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"lock/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(b){if(b[0]){$("#b-admin").trigger("click")}else{alert(b[1])}}})})}function unprotect(){$(document).on("click","#m-unprotect",function(){event.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"unprotect/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(b){if(b[0]){$("#b-admin").trigger("click")}else{alert(b[1])}}})})}function hide(){$(document).on("click","#m-hide",function(){event.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"hide/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(b){if(b[0]){$("#b-admin").trigger("click")}else{alert(b[1])}}})})}function show(){$(document).on("click","#m-show",function(){event.preventDefault();var a=$("article").attr("id");$.ajax({type:"POST",url:api+"show/",xhrFields:{withCredentials:true},dataType:"json",data:{id:a},success:function(b){if(b[0]){$("#b-admin").trigger("click")}else{alert(b[1])}}})})}function buildToolsMenu(){$(document).on("click","#b-admin",function(){event.preventDefault();var a=$(this).parents("article").attr("id");var b=$("#dropdown-moderator");if(b.css("display")=="block"){b.load("http://programmazione.me/ajax/moderator-menu/",{id:a},function(){var f=$(".dropdown:visible").eq(0),c=f.data("dropdown-trigger"),d=c?parseInt(c.attr("data-horizontal-offset")||0,10):null,e=c?parseInt(c.attr("data-vertical-offset")||0,10):null;if(f.length===0||!c){return}if(f.hasClass("dropdown-relative")){f.css({left:f.hasClass("dropdown-anchor-right")?c.position().left-(f.outerWidth(true)-c.outerWidth(true))-parseInt(c.css("margin-right"),10)+d:c.position().left+parseInt(c.css("margin-left"),10)+d,top:c.position().top+c.outerHeight(true)-parseInt(c.css("margin-top"),10)+e})}else{f.css({left:f.hasClass("dropdown-anchor-right")?c.offset().left-(f.outerWidth()-c.outerWidth())+d:c.offset().left+d,top:c.offset().top+c.outerHeight()+e})}})}else{b.empty()}})}$(document).ready(function(){like();star();submit();approve();returnForRevision();reject();revert();moveToTrash();restore();markAsDraft();close();lock();unprotect();hide();show();buildToolsMenu()});